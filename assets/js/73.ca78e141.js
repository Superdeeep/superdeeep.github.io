(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{426:function(a,t,s){"use strict";s.r(t);var e=s(0),n=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"安装mariadb数据库-mysql的分支"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装mariadb数据库-mysql的分支"}},[a._v("#")]),a._v(" "),t("strong",[a._v("安装mariadb数据库")]),a._v("(mysql的分支)")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" mariadb-server mariadb-client python3-pymysql\n")])])]),t("p",[a._v("ps:")]),a._v(" "),t("p",[a._v("可以不要mariadb-client")]),a._v(" "),t("p",[t("strong",[a._v("数据库配置")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/mysql/mariadb.conf.d/24-openstack.cnf\n")])])]),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("mysqld")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("bind-address")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("0.0.0.0")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("default-storage-engine")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("innodb")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_file_per_table")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("on")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("max_connections")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("4096")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("collation-server")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("utf8_general_ci")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("character-set-server")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("utf8")]),a._v("\n")])])]),t("p",[t("strong",[a._v("重启数据库服务")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl restart mysql\n")])])]),t("p",[t("strong",[a._v("设置开机启动")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("enable")]),a._v(" mysql\n")])])]),t("p",[t("strong",[a._v("初始化数据库")]),a._v(" 一路yes 密码设置为123456")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" mysql_secure_installation\n")])])]),t("h2",{attrs:{id:"安装message-queue"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装message-queue"}},[a._v("#")]),a._v(" "),t("strong",[a._v("安装Message queue")])]),a._v(" "),t("br"),a._v(" "),t("p",[t("strong",[a._v("安装rabbitmq-server")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" rabbitmq-server\n")])])]),t("p",[t("strong",[a._v("添加用户")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("sudosudo rabbitmqctl add_user openstack RABBIT_PASS\n")])])]),t("p",[t("strong",[a._v("设置权限")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" rabbitmqctl set_permissions openstack "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('".*"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('".*"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('".*"')]),a._v("\n")])])]),t("p",[t("strong",[a._v("加个插件")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" rabbitmq-plugins "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("enable")]),a._v(" rabbitmq_management \n")])])]),t("p",[t("strong",[a._v("启动rabbitmq并设置开机启动")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl start rabbitmq-server\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("enable")]),a._v(" rabbitmq-server\n")])])]),t("h2",{attrs:{id:"安装memcached"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装memcached"}},[a._v("#")]),a._v(" "),t("strong",[a._v("安装Memcached")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" memcached python3-memcache\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/memcached.conf\n")])])]),t("p",[a._v("找到 -l 127.0.0.1 改为:")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-l")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1,::1,192.168.2.24\n")])])]),t("p",[a._v("ps:192.168.2.24替换为你的控制节点的管理IP地址")]),a._v(" "),t("p",[t("strong",[a._v("重启服务")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl restart memcached\n")])])]),t("p",[t("strong",[a._v("修改 Memcached 的服务参数，避免开机时启动失败。")])]),a._v(" "),t("p",[a._v("选项\nAfter=network.target\n修改为\nAfter=network-online.target")]),a._v(" "),t("p",[a._v("建议以注释的方式修改")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /usr/lib/systemd/system/memcached.service    \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 修改了 Memcached 启动参数 注意")]),a._v("\n")])])]),t("p",[t("strong",[a._v("启动 Memcached 服务并设置开机启动")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl daemon-reload???\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl restart memcached\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("enable")]),a._v(" memcached\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl status memcached\n\n")])])]),t("h2",{attrs:{id:"安装etcd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装etcd"}},[a._v("#")]),a._v(" "),t("strong",[a._v("安装etcd")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" etcd\n")])])]),t("p",[t("strong",[a._v("修改etcd配置文件")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/default/etcd\n")])])]),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ETCD_NAME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token inner-value"}},[a._v("controller124")]),a._v('"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ETCD_DATA_DIR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token inner-value"}},[a._v("/var/lib/etcd")]),a._v('"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ETCD_INITIAL_CLUSTER_STATE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token inner-value"}},[a._v("new")]),a._v('"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ETCD_INITIAL_CLUSTER_TOKEN")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token inner-value"}},[a._v("etcd-cluster-01")]),a._v('"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ETCD_INITIAL_CLUSTER")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token inner-value"}},[a._v("controller124=http://192.168.2.24:2380")]),a._v('"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ETCD_INITIAL_ADVERTISE_PEER_URLS")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token inner-value"}},[a._v("http://192.168.2.24:2380")]),a._v('"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ETCD_ADVERTISE_CLIENT_URLS")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token inner-value"}},[a._v("http://192.168.2.24:2379")]),a._v('"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ETCD_LISTEN_PEER_URLS")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token inner-value"}},[a._v("http://0.0.0.0:2380")]),a._v('"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ETCD_LISTEN_CLIENT_URLS")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token inner-value"}},[a._v("http://192.168.2.24:2379")]),a._v('"')]),a._v("\n")])])]),t("p",[t("strong",[a._v("启动etcd并设置开机启动")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl restart etcd\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("enable")]),a._v(" etcd\n")])])]),t("p",[t("strong",[a._v("测试etcd")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("etcdctl "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--endpoints")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://controller124:2379"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" 001 法外狂徒张三\n\netcdctl "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--endpoints")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://controller124:2379"')]),a._v(" get 001\n")])])]),t("h2",{attrs:{id:"安装keystone"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装keystone"}},[a._v("#")]),a._v(" "),t("strong",[a._v("安装keystone")])]),a._v(" "),t("p",[t("strong",[a._v("创建数据库")])]),a._v(" "),t("p",[a._v("KEYSTONE_DBPASS为要设置的密码")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("mysql "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("u root "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("p\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DATABASE")]),a._v(" keystone"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("GRANT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALL")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("PRIVILEGES")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ON")]),a._v(" keystone"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'keystone'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'localhost'")]),a._v(" IDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'KEYSTONE_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("GRANT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALL")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("PRIVILEGES")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ON")]),a._v(" keystone"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'keystone'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'%'")]),a._v(" IDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'KEYSTONE_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" keystone"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("tables")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n")])])]),t("p",[t("strong",[a._v("安装组件")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" keystone\n")])])]),t("p",[t("strong",[a._v("编辑配置文件")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/keystone/keystone.conf\n")])])]),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("database")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("connection")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mysql+pymysql://keystone:KEYSTONE_DBPASS@controller124/keystone")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("token")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("provider")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("fernet")]),a._v("\n")])])]),t("p",[t("strong",[a._v("填充数据库：")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /etc/keystone/\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /bin/sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"keystone-manage db_sync"')]),a._v(" keystone\n")])])]),t("p",[t("strong",[a._v("初始化密钥")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("keystone-manage fernet_setup --keystone-user keystone --keystone-group keystone\nkeystone-manage credential_setup --keystone-user keystone --keystone-group keystone\n")])])]),t("p",[t("strong",[a._v("创建引导服务")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" keystone-manage bootstrap --bootstrap-password ADMIN_PASS "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --bootstrap-admin-url http://controller124:5000/v3/ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --bootstrap-internal-url http://controller124:5000/v3/ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --bootstrap-public-url http://controller124:5000/v3/ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --bootstrap-region-id RegionOne\n")])])]),t("p",[t("strong",[a._v("在")]),a._v("/etc/apache2/apache2.conf"),t("strong",[a._v("查看")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/apache2/apache2.conf \n")])])]),t("p",[a._v("如果不存在\n"),t("code",[a._v("ServerName controller")]),a._v("\n这一行则在其中添加")]),a._v(" "),t("p",[a._v("重启Apache")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("enable")]),a._v(" apache2\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl restart apache2\n")])])]),t("p",[a._v("查看Apache的服务状态")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("systemctl status apache2\n")])])]),t("p",[a._v("source ./admin-openrc-fish.sh")]),a._v(" "),t("p",[t("strong",[a._v("进行一些确认和验证")])]),a._v(" "),t("p",[a._v("查询刚创建的用户的ID")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack user list\n")])])]),t("p",[a._v("复制上文的用户ID，关联项目admin，用户admin，角色admin。")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack role "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--project")]),a._v(" admin "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--user")]),a._v(" 替换为用户ID admin\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" ./admin-openrc-fish.sh\n")])])]),t("p",[a._v("查看token，可以多运行几次，查看 token id 是否更新。")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack token issue\n")])])]),t("p",[a._v("清除环境变量后：")]),a._v(" "),t("p",[a._v("使用 openstack 命令验证是否能够获取 Token")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack --os-auth-url http://controller124:5000/v3 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --os-project-domain-name default --os-user-domain-name default "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --os-project-name admin --os-username admin --os-auth-type password "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --os-password ADMIN_PASS token issue\n")])])]),t("p",[a._v("查询 keystone identity service，表里应该只有一行记录。")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" /etc/keystone/admin-openrc\nopenstack "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" list "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-E")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ID|keystone"')]),a._v("\n")])])]),t("p",[a._v("查询 keystone endpoint，表里应该有3行记录。")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" /etc/keystone/admin-openrc\nopenstack endpoint list "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-E")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ID|keystone"')]),a._v("\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v(" opst-proc-show.sh\n")])])]),t("h2",{attrs:{id:"安装glance"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装glance"}},[a._v("#")]),a._v(" 安装Glance")]),a._v(" "),t("h4",{attrs:{id:"创建数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建数据库"}},[a._v("#")]),a._v(" 创建数据库")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" root "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v("\nCREATE DATABASE glance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nGRANT ALL PRIVILEGES ON glance.* TO "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'glance'")]),a._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'localhost'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'GLANCE_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nGRANT ALL PRIVILEGES ON glance.* TO "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'glance'")]),a._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'GLANCE_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("GLANCE_DBPASS为要设置的密码")]),a._v(" "),t("h4",{attrs:{id:"创建glance用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建glance用户"}},[a._v("#")]),a._v(" 创建glance用户")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" ./admin-openrc-fish.sh\nopenstack user create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--domain")]),a._v(" default "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--password")]),a._v(" GLANCE_PASS glance\n")])])]),t("h4",{attrs:{id:"将glacne添加到admin中去"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#将glacne添加到admin中去"}},[a._v("#")]),a._v(" 将glacne添加到admin中去")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack project create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--domain")]),a._v(" default "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--description")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Service Project"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v("\nopenstack role "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--project")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--user")]),a._v(" glance admin\nopenstack user create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--domain")]),a._v(" default "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--password")]),a._v(" MY_PASSWORD MY_SERVICE\nopenstack role "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--user")]),a._v(" MY_SERVICE --user-domain Default "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--system")]),a._v(" all reader\n")])])]),t("h4",{attrs:{id:"创建glance服务实体"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建glance服务实体"}},[a._v("#")]),a._v(" 创建glance服务实体")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" glance "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--description")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"OpenStack Image"')]),a._v(" image\n")])])]),t("h4",{attrs:{id:"创建image服务api端点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建image服务api端点"}},[a._v("#")]),a._v(" 创建Image服务API端点")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack endpoint create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--region")]),a._v(" RegionOne "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  image public http://controller124:9292\nopenstack endpoint create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--region")]),a._v(" RegionOne "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  image internal http://controller124:9292\nopenstack endpoint create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--region")]),a._v(" RegionOne "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  image admin http://controller124:9292\n")])])]),t("h4",{attrs:{id:"安装组件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装组件"}},[a._v("#")]),a._v(" 安装组件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" glance "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("\n")])])]),t("h4",{attrs:{id:"配置组件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置组件"}},[a._v("#")]),a._v(" 配置组件")]),a._v(" "),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[a._v("vim /etc/glance/glance-api.conf\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("DEFAULT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("use_keystone_quotas")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("True")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("barbican")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("barbican_service_user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("cinder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("cors")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("database")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("connection")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mysql+pymysql://glance:GLANCE_DBPASS@controller124/glance")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("file")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("glance.store.http.store")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("glance.store.rbd.store")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("glance.store.s3.store")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("glance.store.swift.store")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("glance.store.vmware_datastore.store")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("glance_store")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("stores")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("file,http")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("default_store")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("file")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("filesystem_store_datadir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/lib/glance/images/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("healthcheck")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("image_format")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("key_manager")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("keystone_authtoken")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_url")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://controller124:5000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("www_authenticate_uri")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://controller124:5000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("memcached_servers")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("controller124:11211")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("password")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("project_domain_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user_domain_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("project_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("service")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("username")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("glance")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("password")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("GLANCE_PASS")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_concurrency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_messaging_amqp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_messaging_kafka")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_messaging_notifications")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_messaging_rabbit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_middleware")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_policy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_reports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("paste_deploy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("flavor")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("keystone")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("profiler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("store_type_location_strategy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("task")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("taskflow_executor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("vault")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("wsgi")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_limit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_url")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://controller124:5000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("password")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user_domain_id")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("username")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("MY_SERVICE")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("system_scope")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("all")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("password")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("MY_PASSWORD")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("endpoint_id")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ENDPOINT_ID")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("region_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("RegionOne")]),a._v("\n")])])]),t("p",[a._v("GLANCE_DBPASS为创建glance用户访问数据库的密码")]),a._v(" "),t("p",[a._v("GLANCE_PASS为openstack创建glance用户设置的密码")]),a._v(" "),t("p",[a._v("GLANCE_PASS为openstack创建glance用户设置的密码")]),a._v(" "),t("p",[a._v("endpoint_id为创建Image服务API端点中类型为public的id\n可以通过如下的命令查看")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack endpoint list\n")])])]),t("h4",{attrs:{id:"填充数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#填充数据库"}},[a._v("#")]),a._v(" 填充数据库")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /etc/glance\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /bin/sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"glance-manage db_sync"')]),a._v(" glance\n")])])]),t("p",[a._v("运行成功会显示"),t("code",[a._v("Database is synced successfully.")])]),a._v(" "),t("p",[a._v("进入 MariaDB 查看是否有表格出现。密码为"),t("code",[a._v("GLANCE_DBPASS")]),a._v("。如果有则表示数据库同步成功。")]),a._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("mysql")]),a._v(" -u glance -p\nuse glance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" tables")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h4",{attrs:{id:"重启image服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重启image服务"}},[a._v("#")]),a._v(" 重启Image服务")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("systemctl restart glance-api\n")])])]),t("p",[a._v("查看 Glance 服务是否active。")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("systemctl status openstack-glance-api\n")])])]),t("h4",{attrs:{id:"验证配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#验证配置"}},[a._v("#")]),a._v(" 验证配置")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" ./admin-openrc-fish.sh\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" http://download.cirros-cloud.net/0.4.0/cirros-0.4.0-x86_64-disk.img\nglance image-create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"cirros"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--file")]),a._v(" /root/cirros-0.4.0-x86_64-disk.img "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --disk-format qcow2 --container-format bare "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--visibility")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("public\nglance image-list\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 输出如下的内容表示组件成功运行")]),a._v("\nroot@controller124:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# glance image-list")]),a._v("\n+--------------------------------------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" ID                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Name   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+--------------------------------------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" 8244fbc0-f798-44c5-b0f3-9e5566e7e345 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" cirros "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+--------------------------------------+--------+\n")])])]),t("h2",{attrs:{id:"安装placement"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装placement"}},[a._v("#")]),a._v(" 安装Placement")]),a._v(" "),t("h4",{attrs:{id:"创建数据库-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建数据库-2"}},[a._v("#")]),a._v(" 创建数据库")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" root "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v("\nCREATE DATABASE placement"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nGRANT ALL PRIVILEGES ON placement.* TO "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'placement'")]),a._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'localhost'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'PLACEMENT_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nGRANT ALL PRIVILEGES ON placement.* TO "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'placement'")]),a._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'PLACEMENT_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("PLACEMENT_DBPASS为要设置的密码")]),a._v(" "),t("p",[a._v("创建placement用户")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" ./admin-openrc-fish.sh\nopenstack user create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--domain")]),a._v(" default "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--password")]),a._v(" PLACEMENT_PASS placement\n")])])]),t("h4",{attrs:{id:"将用户添加到admin"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#将用户添加到admin"}},[a._v("#")]),a._v(" 将用户添加到admin")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack role "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--project")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--user")]),a._v(" placement admin \n")])])]),t("h4",{attrs:{id:"创建placement服务实体"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建placement服务实体"}},[a._v("#")]),a._v(" 创建placement服务实体")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" placement "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--description")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Placement API"')]),a._v(" placement\n")])])]),t("h4",{attrs:{id:"创建api-服务端点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建api-服务端点"}},[a._v("#")]),a._v(" 创建API 服务端点")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack endpoint create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--region")]),a._v(" RegionOne placement public http://controller124:8778\nopenstack endpoint create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--region")]),a._v(" RegionOne placement internal http://controller124:8778\nopenstack endpoint create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--region")]),a._v(" RegionOne placement admin http://controller124:8778\n")])])]),t("h4",{attrs:{id:"安装组件-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装组件-2"}},[a._v("#")]),a._v(" 安装组件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" placement-api "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("\n")])])]),t("h4",{attrs:{id:"配置组件-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置组件-2"}},[a._v("#")]),a._v(" 配置组件")]),a._v(" "),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[a._v("vim /etc/placement/placement.conf\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("DEFAULT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("api")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("cors")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("keystone_authtoken")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_url")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://controller124:5000/v3")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("memcached_servers")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("controller124:11211")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("password")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("project_domain_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user_domain_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("project_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("service")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("username")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("placement")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("password")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("PLACEMENT_PASS")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_middleware")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_policy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("placement")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("placement_database")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("connection")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mysql+pymysql://placement:PLACEMENT_DBPASS@controller124/placement")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("profiler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("auth_strategy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("keystone")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" \n")])])]),t("p",[a._v("PLACEMENT_DBPASS为创建placement用户访问数据库设置的密码")]),a._v(" "),t("p",[a._v("PLACEMENT_PASS为openstack创建placement用户设置的密码")]),a._v(" "),t("h4",{attrs:{id:"填充数据库-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#填充数据库-2"}},[a._v("#")]),a._v(" 填充数据库")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /bin/sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"placement-manage db sync"')]),a._v(" placement\n")])])]),t("h4",{attrs:{id:"重启apache2服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重启apache2服务"}},[a._v("#")]),a._v(" 重启apache2服务")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("systemctl restart apache2\n")])])]),t("p",[a._v("进入 MariaDB 查看是否有表格出现。密码为"),t("code",[a._v("PLACEMENT_DBPASS")]),a._v("。如果有则表示数据库同步成功。")]),a._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("mysql")]),a._v(" -u placement -pPLACEMENT_DBPASS\nuse placement")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" tables")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exit")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("strong",[a._v("验证配置")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" ./admin-openrc-fish.sh\nplacement-status upgrade check\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 输出如下的内容表示成功")]),a._v("\nroot@controller124:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# placement-status upgrade check")]),a._v("\n+-------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Upgrade Check Results                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+-------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Check: Missing Root Provider IDs          "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Result: Success                           "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Details: None                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+-------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Check: Incomplete Consumers               "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Result: Success                           "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Details: None                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+-------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Check: Policy File JSON to YAML Migration "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Result: Success                           "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Details: None                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+-------------------------------------------+\nopenstack --os-placement-api-version "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.2")]),a._v(" resource class list --sort-column name\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 输出如下的内容表示成功")]),a._v("\nroot@controller124:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# openstack --os-placement-api-version 1.2 resource class list --sort-column name")]),a._v("\n+----------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" name                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+----------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" DISK_GB                                "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" FPGA                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" IPV4_ADDRESS                           "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" MEMORY_MB                              "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" MEM_ENCRYPTION_CONTEXT                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" NET_BW_EGR_KILOBIT_PER_SEC             "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" NET_BW_IGR_KILOBIT_PER_SEC             "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" NET_PACKET_RATE_EGR_KILOPACKET_PER_SEC "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" NET_PACKET_RATE_IGR_KILOPACKET_PER_SEC "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" NET_PACKET_RATE_KILOPACKET_PER_SEC     "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" NUMA_CORE                              "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" NUMA_MEMORY_MB                         "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" NUMA_SOCKET                            "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" NUMA_THREAD                            "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" PCI_DEVICE                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" PCPU                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" PGPU                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" SRIOV_NET_VF                           "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" VCPU                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" VGPU                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" VGPU_DISPLAY_HEAD                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+----------------------------------------+\nopenstack --os-placement-api-version "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.6")]),a._v(" trait list --sort-column name\n")])])]),t("h2",{attrs:{id:"安装nova"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nova"}},[a._v("#")]),a._v(" 安装Nova")]),a._v(" "),t("h4",{attrs:{id:"创建数据库-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建数据库-3"}},[a._v("#")]),a._v(" 创建数据库")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysql\nCREATE DATABASE nova_api"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nCREATE DATABASE nova"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nCREATE DATABASE nova_cell0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nGRANT ALL PRIVILEGES ON nova_api.* TO "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'nova'")]),a._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'localhost'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'NOVA_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nGRANT ALL PRIVILEGES ON nova_api.* TO "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'nova'")]),a._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'NOVA_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nGRANT ALL PRIVILEGES ON nova.* TO "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'nova'")]),a._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'localhost'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'NOVA_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nGRANT ALL PRIVILEGES ON nova.* TO "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'nova'")]),a._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'NOVA_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nGRANT ALL PRIVILEGES ON nova_cell0.* TO "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'nova'")]),a._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'localhost'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'NOVA_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nGRANT ALL PRIVILEGES ON nova_cell0.* TO "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'nova'")]),a._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'NOVA_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),a._v("\n")])])]),t("p",[a._v("NOVA_DBPASS为要设置的密码")]),a._v(" "),t("p",[t("strong",[a._v("创建nova用户")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("admin-openrc.sh\nopenstack user create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--domain")]),a._v(" default --password-prompt nova\n")])])]),t("h4",{attrs:{id:"添加到admin"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加到admin"}},[a._v("#")]),a._v(" 添加到admin")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack role "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--project")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--user")]),a._v(" nova admin\n")])])]),t("h4",{attrs:{id:"创建nova服务实体"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建nova服务实体"}},[a._v("#")]),a._v(" 创建nova服务实体")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" nova "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--description")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"OpenStack Compute"')]),a._v(" compute\n")])])]),t("h4",{attrs:{id:"创建api服务端点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建api服务端点"}},[a._v("#")]),a._v(" 创建API服务端点")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack endpoint create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--region")]),a._v(" RegionOne "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  compute public http://controller124:8774/v2.1\nopenstack endpoint create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--region")]),a._v(" RegionOne "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  compute internal http://controller124:8774/v2.1\nopenstack endpoint create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--region")]),a._v(" RegionOne "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  compute admin http://controller124:8774/v2.1\n")])])]),t("h4",{attrs:{id:"安装组件-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装组件-3"}},[a._v("#")]),a._v(" 安装组件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" nova-api nova-conductor nova-novncproxy nova-scheduler\n")])])]),t("h4",{attrs:{id:"配置组件-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置组件-3"}},[a._v("#")]),a._v(" 配置组件")]),a._v(" "),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[a._v("vim /etc/nova/nova.conf\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("DEFAULT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("enabled_apis")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("osapi_compute,metadata")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("rpc_backend")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("rabbit")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_strategy")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("keystone")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("my_ip")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("192.168.2.24")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("use_neutron")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("True")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("firewall_driver")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("nova.virt.firewall.NoopFirewallDriver")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport_url")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("rabbit://openstack:RABBIT_PASS@controller124:5672/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("verbose")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("True")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("debug")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("True")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_dir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/log/nova")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("api")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_strategy")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("keystone")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("api_database")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("connection")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mysql+pymysql://nova:NOVA_DBPASS@controller124/nova_api")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("barbican")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("barbican_service_user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("cache")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("cinder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("compute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("conductor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("consoleauth")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("cors")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("cyborg")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("database")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("connection")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mysql+pymysql://nova:NOVA_DBPASS@controller124/nova")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("devices")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("ephemeral_storage_encryption")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("filter_scheduler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("glance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("api_servers")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://controller124:9292")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("guestfs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("healthcheck")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("hyperv")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("image_cache")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("ironic")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("key_manager")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("keystone")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("keystone_authtoken")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("www_authenticate_uri")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://controller124:5000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_url")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://controller124:5000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("memcached_servers")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("controller124:11211")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("password")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("project_domain_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user_domain_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("project_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("service")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("username")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("nova")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("password")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NOVA_PASS")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("libvirt")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("metrics")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("mks")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("neutron")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_url")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://controller124:5000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("password")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("project_domain_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user_domain_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("region_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("RegionOne")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("project_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("service")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("username")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("neutron")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("password")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NEUTRON_PASS")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("service_metadata_proxy")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("True")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("metadata_proxy_shared_secret")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("METADATA_PASS")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("insecure")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("false")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("notifications")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_concurrency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("lock_path")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/lib/nova/tmp")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_messaging_amqp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_messaging_kafka")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_messaging_notifications")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_messaging_rabbit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_middleware")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_policy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("oslo_reports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("pci")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("placement")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("region_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("RegionOne")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("project_domain_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("project_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("service")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("password")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user_domain_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_url")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://controller124:5000/v3")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("username")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("placement")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("password")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("PLACEMENT_PASS")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("powervm")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("privsep")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("profiler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("quota")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("rdp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("remote_debug")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("scheduler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("serial_console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("service_user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("send_service_user_token")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_url")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://controller124:5000/identity")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_strategy")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("keystone")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth_type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("password")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("project_domain_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("project_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("service")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user_domain_name")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Default")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("username")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("nova")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("password")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NOVA_PASS")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("spice")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("upgrade_levels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("vault")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("vendordata_dynamic_auth")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("vmware")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("vnc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("enabled")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server_listen")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("$my_ip")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server_proxyclient_address")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("$my_ip")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("workarounds")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("wsgi")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("zvm")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n")])])]),t("p",[a._v("NOVA_DBPASS为创建nova用户设置访问数据库的密码")]),a._v(" "),t("p",[a._v("NOVA_DBPASS为创建nova用户设置访问数据库的密码")]),a._v(" "),t("p",[a._v("RABBIT_PASS为rabbitmqctl创建openstack设置的密码\nmy_ip为Controller节点的IP地址")]),a._v(" "),t("p",[a._v("NOVA_PASS为openstack创建nova用户设置的密码")]),a._v(" "),t("p",[a._v("NOVA_PASS为openstack创建nova用户设置的密码")]),a._v(" "),t("p",[a._v("PLACEMENT_PASS为openstack创建placement用户设置的密码")]),a._v(" "),t("h4",{attrs:{id:"填充数据库-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#填充数据库-3"}},[a._v("#")]),a._v(" 填充数据库")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /bin/sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nova-manage api_db sync"')]),a._v(" nova\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /bin/sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nova-manage cell_v2 map_cell0"')]),a._v(" nova\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /bin/sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nova-manage cell_v2 create_cell --name=cell1 --verbose"')]),a._v(" nova\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /bin/sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nova-manage db sync"')]),a._v(" nova\n")])])]),t("h4",{attrs:{id:"验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#验证"}},[a._v("#")]),a._v(" 验证")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /bin/sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nova-manage cell_v2 list_cells"')]),a._v(" nova\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 输出类似如下的内容")]),a._v("\nroot@controller124:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('# su -s /bin/sh -c "nova-manage cell_v2 list_cells" nova')]),a._v("\n+-------+--------------------------------------+------------------------------------------+-------------------------------------------------+----------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("  Name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("                 UUID                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("              Transport URL               "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("               Database Connection               "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Disabled "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+-------+--------------------------------------+------------------------------------------+-------------------------------------------------+----------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" cell0 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" 00000000-0000-0000-0000-000000000000 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("                  none:/                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" mysql+pymysql://nova:****@controller124/nova_cell0 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("  False   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" cell1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" e52327df-10e2-41e1-a1d2-5d7724a85688 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" rabbit://openstack:****@controller124:5672/ "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("    mysql+pymysql://nova:****@controller124/nova    "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("  False   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+-------+--------------------------------------+------------------------------------------+-------------------------------------------------+----------+\n")])])]),t("h4",{attrs:{id:"重启服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重启服务"}},[a._v("#")]),a._v(" 重启服务")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("systemctl restart nova-api nova-scheduler nova-conductor nova-novncproxy\n")])])]),t("h3",{attrs:{id:"配置compute节点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置compute节点"}},[a._v("#")]),a._v(" 配置Compute节点")]),a._v(" "),t("h3",{attrs:{id:"compute节点配置完成后"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#compute节点配置完成后"}},[a._v("#")]),a._v(" Compute节点配置完成后....")]),a._v(" "),t("h3",{attrs:{id:"在控制节点添加计算节点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在控制节点添加计算节点"}},[a._v("#")]),a._v(" 在控制节点添加计算节点")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" ./admin-openrc-fish.sh\nopenstack compute "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" list "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--service")]),a._v(" nova-compute\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 输出如下的内容")]),a._v("\nroot@controller124:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# openstack compute service list --service nova-compute")]),a._v("\n+--------------------------------------+--------------+----------+------+---------+-------+----------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" ID                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Binary       "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Host     "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Zone "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Status  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" State "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Updated At                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+--------------------------------------+--------------+----------+------+---------+-------+----------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" c9dd606c-0f31-4a9e-9c6f-bb40e33cf054 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" nova-compute "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" compute124 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" nova "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" enabled "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" up    "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2024")]),a._v("-03-31T08:01:53.000000 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+--------------------------------------+--------------+----------+------+---------+-------+----------------------------+\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /bin/sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nova-manage cell_v2 discover_hosts --verbose"')]),a._v(" nova\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 输出如下的内容")]),a._v("\nroot@controller124:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('# su -s /bin/sh -c "nova-manage cell_v2 discover_hosts --verbose" nova')]),a._v("\nFound "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" cell mappings.\nSkipping cell0 since it does not contain hosts.\nGetting computes from cell "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'cell1'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" e52327df-10e2-41e1-a1d2-5d7724a85688\nChecking "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" mapping "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" compute "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'compute1'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" 844b86c1-7310-4ddf-82cd-0b8f3350ef0d\nCreating "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" mapping "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" compute "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'compute1'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" 844b86c1-7310-4ddf-82cd-0b8f3350ef0d\nFound "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" unmapped computes "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" cell: e52327df-10e2-41e1-a1d2-5d7724a85688\n")])])]),t("h3",{attrs:{id:"验证配置-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#验证配置-2"}},[a._v("#")]),a._v(" 验证配置")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack compute "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" list\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 输出如下的内容")]),a._v("\nroot@controller124:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# openstack compute service list")]),a._v("\n+--------------------------------------+----------------+------------+----------+---------+-------+----------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" ID                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Binary         "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Host       "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Zone     "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Status  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" State "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Updated At                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+--------------------------------------+----------------+------------+----------+---------+-------+----------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" 2779af9c-cde5-41a6-87b2-5b6840d9b88b "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" nova-conductor "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" controller124 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" internal "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" enabled "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" up    "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2024")]),a._v("-03-31T08:03:07.000000 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" b24be4f1-ea05-4ee3-a7eb-8402ff53f172 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" nova-scheduler "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" controller124 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" internal "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" enabled "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" up    "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2024")]),a._v("-03-31T08:03:15.000000 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" c9dd606c-0f31-4a9e-9c6f-bb40e33cf054 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" nova-compute   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" compute124   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" nova     "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" enabled "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" up    "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2024")]),a._v("-03-31T08:03:13.000000 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+--------------------------------------+----------------+------------+----------+---------+-------+----------------------------+\nopenstack catalog list\nopenstack image list\nnova-status upgrade check\n")])])]),t("h2",{attrs:{id:"安装neutron-使用的是ovn"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装neutron-使用的是ovn"}},[a._v("#")]),a._v(" 安装Neutron（使用的是OVN）")]),a._v(" "),t("h4",{attrs:{id:"创建数据库-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建数据库-4"}},[a._v("#")]),a._v(" 创建数据库")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysql\nCREATE DATABASE neutron"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nGRANT ALL PRIVILEGES ON neutron.* TO "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'neutron'")]),a._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'localhost'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'NEUTRON_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nGRANT ALL PRIVILEGES ON neutron.* TO "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'neutron'")]),a._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'NEUTRON_DBPASS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("NEUTRON_DBPASS为要设置的密码")]),a._v(" "),t("h4",{attrs:{id:"创建neutron用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建neutron用户"}},[a._v("#")]),a._v(" 创建neutron用户")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" ./admin-openrc-fish.sh\nopenstack user create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--domain")]),a._v(" default --password-prompt neutron\n")])])]),t("h4",{attrs:{id:"添加到admin-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加到admin-2"}},[a._v("#")]),a._v(" 添加到admin")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack role "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--project")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--user")]),a._v(" neutron admin\n")])])]),t("h4",{attrs:{id:"创建neutron服务实体"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建neutron服务实体"}},[a._v("#")]),a._v(" 创建neutron服务实体")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" neutron "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--description")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"OpenStack Networking"')]),a._v(" network\n")])])]),t("h4",{attrs:{id:"创建api端点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建api端点"}},[a._v("#")]),a._v(" 创建API端点")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack endpoint create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--region")]),a._v(" RegionOne "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  network public http://controller124:9696\nopenstack endpoint create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--region")]),a._v(" RegionOne "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  network internal http://controller124:9696\nopenstack endpoint create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--region")]),a._v(" RegionOne "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  network admin http://controller124:9696\n")])])]),t("h4",{attrs:{id:"安装组件-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装组件-4"}},[a._v("#")]),a._v(" 安装组件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" neutron-server neutron-plugin-ml2 python3-neutronclient ovn-central openvswitch-switch\n")])])]),t("h4",{attrs:{id:"配置组件-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置组件-4"}},[a._v("#")]),a._v(" 配置组件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/neutron/neutron.conf\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("DEFAULT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nbind_host "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" controller124\nbind_port "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("9696")]),a._v("\ncore_plugin "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" ml2\nservice_plugins "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" ovn-router\nauth_strategy "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" keystone\nstate_path "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" /var/lib/neutron\nallow_overlapping_ips "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" True\nnotify_nova_on_port_status_changes "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" True\nnotify_nova_on_port_data_changes "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" True\ntransport_url "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" rabbit://openstack:RABBIT_PASS@controller124\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("agent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("cache"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("cors"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("database"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nconnection "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" mysql+pymysql://neutron:NEUTRON_DBPASS@controller124/neutron\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("healthcheck"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("ironic"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("keystone_authtoken"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nwww_authenticate_uri "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" http://controller124:5000\nauth_url "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" http://controller124:5000\nmemcached_servers "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" controller124:11211\nauth_type "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" password\nproject_domain_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" Default\nuser_domain_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" Default\nproject_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v("\nusername "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" neutron\npassword "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" NEUTRON_PASS\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("nova"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nauth_url "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" http://controller124:5000\nauth_type "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" password\nproject_domain_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" Default\nuser_domain_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" Default\nregion_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" RegionOne\nproject_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v("\nusername "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" nova\npassword "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" NOVA_PASS\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("oslo_concurrency"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nlock_path "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" /var/lib/neutron/tmp\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("oslo_messaging_amqp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("oslo_messaging_kafka"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("oslo_messaging_notifications"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("oslo_messaging_rabbit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("oslo_messaging_rabbit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("oslo_middleware"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("oslo_policy"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("oslo_reports"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("placement"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("privsep"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("profiler"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("quotas"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("ssl"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n")])])]),t("p",[a._v("RABBIT_PASS为rabbit创建openstack用户创建的密码")]),a._v(" "),t("p",[a._v("NEUTRON_PASS为openstack创建neutron用户设置的密码")]),a._v(" "),t("p",[a._v("NEUTRON_PASS为创建neutron用户访问数据库设置的密码")]),a._v(" "),t("p",[a._v("NOVA_PASS为openstack创建nova用户设置的密码")]),a._v(" "),t("p",[a._v("ControllerIP为Controller节点的IP地址")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/default/openvswitch-switch\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("OVS_CTL_OPTS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"--ovsdb-server-options='--remote=ptcp:6640:127.0.0.1'\"")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/nova/nova.conf\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("neutron"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nauth_url "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" http://controller124:5000\nauth_type "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" password\nproject_domain_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" Default\nuser_domain_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" Default\nregion_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" RegionOne\nproject_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v("\nusername "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" neutron\npassword "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" NEUTRON_PASS\nservice_metadata_proxy "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" True\nmetadata_proxy_shared_secret "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" METADATA_PASS\ninsecure "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("\n")])])]),t("p",[a._v("NEUTRON_PASS为openstack创建neutron用户设置的密码\nMETADATA_PASS为创建的密码")]),a._v(" "),t("h4",{attrs:{id:"填充数据库-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#填充数据库-4"}},[a._v("#")]),a._v(" 填充数据库")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /bin/sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"neutron-db-manage --config-file /etc/neutron/neutron.conf \\\n  --config-file /etc/neutron/plugins/ml2/ml2_conf.ini upgrade head"')]),a._v(" neutron\n")])])]),t("h4",{attrs:{id:"重启服务-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重启服务-2"}},[a._v("#")]),a._v(" 重启服务")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("systemctl restart nova-api\nsystemctl restart openvswitch-switch\novs-vsctl add-br br-int \nsystemctl restart ovn-central ovn-northd\novn-nbctl set-connection ptcp:6641:Controller的IP -- "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" connection "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("inactivity_probe")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("60000")]),a._v("\novn-sbctl set-connection ptcp:6642:Controller的IP -- "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" connection "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("inactivity_probe")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("60000")]),a._v("\n")])])]),t("p",[a._v("ControllerIP为Controller节点的IP地址")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("systemctl restart neutron-server\n")])])]),t("h3",{attrs:{id:"在compute节点配置完neutron后"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在compute节点配置完neutron后"}},[a._v("#")]),a._v(" 在Compute节点配置完Neutron后")]),a._v(" "),t("h3",{attrs:{id:"配置验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置验证"}},[a._v("#")]),a._v(" 配置验证")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" ./admin-openrc-fish.sh \nopenstack network agent list\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 输入如下的内容表示成功")]),a._v("\nroot@controller124:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# openstack network agent list")]),a._v("\n+--------------------------------------+----------------------+----------+-------------------+-------+-------+----------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" ID                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Agent Type           "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Host     "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Availability Zone "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Alive "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" State "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Binary                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+--------------------------------------+----------------------+----------+-------------------+-------+-------+----------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" e42ab135-4870-4bfd-8b90-47ad92732627 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" OVN Controller agent "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" compute1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" :-"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" UP    "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" ovn-controller             "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" 952c013f-c53d-54b8-89b4-d55930a40171 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" OVN Metadata agent   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" compute1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" :-"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" UP    "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" neutron-ovn-metadata-agent "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+--------------------------------------+----------------------+----------+----------\n")])])]),t("h3",{attrs:{id:"创建ovn网络"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建ovn网络"}},[a._v("#")]),a._v(" 创建OVN网络!!!")]),a._v(" "),t("h4",{attrs:{id:"controller节点-和-compute节点-都需要的操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#controller节点-和-compute节点-都需要的操作"}},[a._v("#")]),a._v(" Controller节点!!! 和 Compute节点!!! 都需要的操作:")]),a._v(" "),t("p",[a._v("开始")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# br-ens34你可以随便取名字")]),a._v("\novs-vsctl add-br br-ens34\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("12")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ens34为第二张网卡的名称")]),a._v("\novs-vsctl add-port br-ens34 ens34\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("12")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# provider你可以随便取名字")]),a._v("\novs-vsctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("open")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" external-ids:ovn-bridge-mappings"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("provider:br-ens34\n")])])]),t("p",[a._v("结束")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 创建一个路由")]),a._v("\nopenstack router create router\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 创建selfservice")]),a._v("\nopenstack network create selfservice --provider-network-type geneve\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 创建selfservice子网")]),a._v("\nopenstack subnet create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--network")]),a._v(" selfservice "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --dns-nameserver "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8.8")]),a._v(".8.8 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--gateway")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("172.16")]),a._v(".1.1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --subnet-range "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("172.16")]),a._v(".1.0/24 selfservice\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 创建外部网络")]),a._v("\nopenstack network create  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--share")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--external")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --provider-physical-network provider "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --provider-network-type flat provider\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 创建外部网络子网")]),a._v("\nopenstack subnet create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--network")]),a._v(" provider "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --allocation-pool "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("start")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".46.240,end"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".46.250 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --dns-nameserver "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8.8")]),a._v(".8.8 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--gateway")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".46.2 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --subnet-range "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".46.0/24 provider\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 给路由设置网关")]),a._v("\nopenstack router "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" router --external-gateway provider\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 给路由添加内部接口")]),a._v("\nopenstack router "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" subnet router selfservice\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 验证是否成功")]),a._v("\nopenstack port list "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--router")]),a._v(" router\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 输入如下的内容表示成功")]),a._v("\nroot@controller124:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# openstack port list --router router")]),a._v("\n+--------------------------------------+------+-------------------+-------------------------------------------------------------------------------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" ID                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" MAC Address       "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Fixed IP Addresses                                                            "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Status "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+--------------------------------------+------+-------------------+-------------------------------------------------------------------------------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" 56a061e8-f5b1-4df8-8dcb-347bb53ecead "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("      "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" fa:16:3e:28:2c:c3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ip_address")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'172.16.1.1'")]),a._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("subnet_id")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'df79d0ea-9548-486c-8c79-b9dfe9da35ff'")]),a._v("     "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" ACTIVE "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" 6a5c3ba2-df0f-4552-91f1-8eafcdd65da0 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("      "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" fa:16:3e:02:f7:16 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ip_address")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'192.168.46.249'")]),a._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("subnet_id")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'d608e2b9-d2e2-423c-bfec-2a23a1516760'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" ACTIVE "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+--------------------------------------+------+-------------------+-------------------------------------------------------------------------------+--------+\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 也可以通过如下的命令查看")]),a._v("\novn-nbctl show\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 输出如下的内容")]),a._v("\nroot@controller124:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ovn-nbctl show")]),a._v("\nswitch dc4e3afc-da27-4e73-b741-a1c8d57434f7 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("neutron-43fe943c-fe1a-4dfe-9f3a-91dc7cdf823f"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("aka provider"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    port 6a5c3ba2-df0f-4552-91f1-8eafcdd65da0\n        type: router\n        router-port: lrp-6a5c3ba2-df0f-4552-91f1-8eafcdd65da0\n    port dcd112c2-dd97-4f40-b7ba-f8d64bd68a5d\n        addresses: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"fa:16:3e:16:bc:3a 192.168.46.246"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n    port provnet-3140ef3f-1dc0-4490-bfdb-134d1c611aec\n        type: localnet\n        addresses: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"unknown"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n    port 201604e9-1146-4536-a56d-965e82e26d8e\n        type: localport\n        addresses: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"fa:16:3e:5e:20:5b 192.168.46.240"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nswitch e7a2f47f-0ea4-4587-bd18-d444a8f1b500 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("neutron-31f3eb52-667f-4b5a-8ef3-3f1d048b29b3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("aka selfservice"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    port d47fb30d-6d47-4d57-bd4d-96f779f6e765\n        type: localport\n        addresses: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"fa:16:3e:47:46:d8 172.16.1.2"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n    port d2183412-590a-4bc0-b992-7efaf8a8c9f1\n        addresses: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"fa:16:3e:a0:e5:23 172.16.1.37"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n    port 56a061e8-f5b1-4df8-8dcb-347bb53ecead\n        type: router\n        router-port: lrp-56a061e8-f5b1-4df8-8dcb-347bb53ecead\nrouter 715fc656-e8f8-4328-aa2d-82b994bcfe2d "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("neutron-43435b65-0e5e-4bc0-90fa-5a01c1aa89c2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("aka router"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    port lrp-56a061e8-f5b1-4df8-8dcb-347bb53ecead\n        mac: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"fa:16:3e:28:2c:c3"')]),a._v("\n        networks: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"172.16.1.1/24"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n    port lrp-6a5c3ba2-df0f-4552-91f1-8eafcdd65da0\n        mac: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"fa:16:3e:02:f7:16"')]),a._v("\n        networks: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"192.168.46.249/24"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        gateway chassis: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("e42ab135-4870-4bfd-8b90-47ad92732627"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n    nat d4d704be-2102-437b-bc4a-0be5504824aa\n        external ip: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"192.168.46.249"')]),a._v("\n        logical ip: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"172.16.1.0/24"')]),a._v("\n        type: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"snat"')]),a._v("\nroot@controller124:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ")]),a._v("\n")])])]),t("h2",{attrs:{id:"安装dashboard"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装dashboard"}},[a._v("#")]),a._v(" 安装Dashboard")]),a._v(" "),t("h4",{attrs:{id:"安装组件-5"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装组件-5"}},[a._v("#")]),a._v(" 安装组件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" openstack-dashboard \n")])])]),t("h4",{attrs:{id:"配置组件-5"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置组件-5"}},[a._v("#")]),a._v(" 配置组件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/openstack-dashboard/local_settings.py\nOPENSTACK_HOST "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"controller124"')]),a._v("\nALLOWED_HOSTS "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'*'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nSESSION_ENGINE "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'django.contrib.sessions.backends.cache'")]),a._v("\nCACHES "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'default'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n         "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'BACKEND'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'django.core.cache.backends.memcached.MemcachedCache'")]),a._v(",\n         "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'LOCATION'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'controller124:11211'")]),a._v(",\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\nOPENSTACK_KEYSTONE_URL "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://%s:5000/v3"')]),a._v(" % OPENSTACK_HOST\nOPENSTACK_KEYSTONE_MULTIDOMAIN_SUPPORT "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" True\nOPENSTACK_API_VERSIONS "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"identity"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"image"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"volume"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(",\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\nOPENSTACK_KEYSTONE_DEFAULT_DOMAIN "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Default"')]),a._v("\nOPENSTACK_KEYSTONE_DEFAULT_ROLE "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"user"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/apache2/conf-available/openstack-dashboard.conf\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 不存在则添加")]),a._v("\nWSGIApplicationGroup %"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("GLOBAL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("h4",{attrs:{id:"如果不能正常访问"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如果不能正常访问"}},[a._v("#")]),a._v(" 如果不能正常访问")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("python3 /usr/share/openstack-dashboard/manage.py compress\n")])])]),t("h4",{attrs:{id:"重启服务-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重启服务-3"}},[a._v("#")]),a._v(" 重启服务")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("systemctl reload apache2.service\n")])])]),t("h3",{attrs:{id:"接下来操作均可在web上操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#接下来操作均可在web上操作"}},[a._v("#")]),a._v(" 接下来操作均可在web上操作")]),a._v(" "),t("h3",{attrs:{id:"创建实例的计算、内存和存储容量的大小"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建实例的计算、内存和存储容量的大小"}},[a._v("#")]),a._v(" 创建实例的计算、内存和存储容量的大小")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack flavor create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--id")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--vcpus")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--ram")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("64")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--disk")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" m1.nano\nopenstack flavor create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--id")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--vcpus")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--ram")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("256")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--disk")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" m1.mini\nopenstack flavor create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--id")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--vcpus")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--ram")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("384")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--disk")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" m1.regular\nopenstack flavor create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--id")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--vcpus")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--ram")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("512")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--disk")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" m1.pro\n")])])]),t("h3",{attrs:{id:"密钥设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#密钥设置"}},[a._v("#")]),a._v(" 密钥设置")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("ssh-keygen "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-q")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-N")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v("\nopenstack keypair create --public-key ~/.ssh/id_rsa.pub mykey\n")])])]),t("h3",{attrs:{id:"设置安全组"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置安全组"}},[a._v("#")]),a._v(" 设置安全组")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("openstack security group rule create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--proto")]),a._v(" icmp default\nopenstack security group rule create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--proto")]),a._v(" tcp --dst-port "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" default\n")])])]),t("p",[a._v("至此控制节点所做的操作已经全部完成。")])])}),[],!1,null,null,null);t.default=n.exports}}]);