(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{478:function(t,s,a){"use strict";a.r(s);var e=a(3),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"本文-🚧施工中🚧-目前仍处于编写的状态-请不要参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#本文-🚧施工中🚧-目前仍处于编写的状态-请不要参考"}},[t._v("#")]),t._v(" 本文 🚧施工中🚧 目前仍处于编写的状态，请不要参考")]),t._v(" "),s("p",[t._v("本文记录的是proxmox-ve_8.3-1.iso安装的过程记录")]),t._v(" "),s("p",[t._v("rufus.exe写入PVE映像到U盘")]),t._v(" "),s("p",[t._v("如果不放心可以启动WindowsPE看看，查看emmc的分区是不是都删掉了")]),t._v(" "),s("p",[t._v("用ventoy安装好像是不行的吧")]),t._v(" "),s("h3",{attrs:{id:"开始安装pve啦"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开始安装pve啦"}},[t._v("#")]),t._v(" 开始安装PVE啦~")]),t._v(" "),s("p",[t._v("1.插入U盘，将R86s开启，引导其从U盘启动，（按F7就好）")]),t._v(" "),s("p",[t._v("2.请不要直接install PVE，因为是EMMC硬盘，会安装失败（我已经帮你试过了）")]),t._v(" "),s("p",[t._v("3.点击 (高级选项)\nInstall Proxmox VE (Debug mode)")]),t._v(" "),s("p",[t._v("4.在第一次提示你可以输入命令的时候输入Ctrl+D，继续安装过程")]),t._v(" "),s("p",[t._v("5.再次提示你可以输入命令的时候输入：")]),t._v(" "),s("p",[t._v("vi /usr/share/perl5/Proxmox/Sys/Block.pm")]),t._v(" "),s("p",[t._v("随后：")]),t._v(" "),s("p",[t._v("可能用得上的vim小知识："),s("br"),t._v("\n（在vim的normal模式，输入/unable to get device快速定位）"),s("br"),t._v("\n（vim快速编辑小技巧，复制是y，粘贴是p，按v进入可视界面，选中高亮之后按下y，即可复制）"),s("br"),t._v("\n（在vim的normal模式输入 :wq 是保存）")]),t._v(" "),s("p",[t._v("找到类似这样的地方：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" elsif "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dev")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=~")]),t._v(" m"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("^/dev/nvme"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("d+n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("d+$"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${dev}")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$partnum")]),t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    die "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"unable to get device for partition '),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$partnum")]),t._v(" on device "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dev")]),s("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("在下面多加一个 elseif：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" elsif "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dev")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=~")]),t._v(" m"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("^/dev/nvme"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("d+n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("d+$"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${dev}")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$partnum")]),t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" elsif "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dev")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=~")]),t._v(" m"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("^/dev/mmcblk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("d+$"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#在这里哦")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${dev}")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$partnum")]),t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    die "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"unable to get device for partition '),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$partnum")]),t._v(" on device "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dev")]),s("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("实体机截图：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://superdeeep.oss-cn-hangzhou.aliyuncs.com/r86sinstalltoemmc.png",alt:"r86sinstalltoemmc"}})]),t._v(" "),s("p",[t._v("保存退出即可")]),t._v(" "),s("p",[t._v("然后输入Ctrl-D 继续安装过程，之后正常安装即可")]),t._v(" "),s("p",[t._v("我的配置：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://superdeeep.oss-cn-hangzhou.aliyuncs.com/readypromox.png",alt:"readypromox"}})]),t._v(" "),s("p",[t._v("最后一切安装完毕后，输入https://192.168.6.100:8006/即可进入后台配置啦~")]),t._v(" "),s("p",[t._v("配置pve自己在这里配置哦：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://superdeeep.oss-cn-hangzhou.aliyuncs.com/image-20250508105702987.png",alt:"image-20250508105702987"}})]),t._v(" "),s("p",[t._v("PVE换源：")]),t._v(" "),s("p",[t._v("有人说换源前建议先更新下证书，否则可能由于证书不可用导致 https 无法使用，进而无法下载所有软件")]),t._v(" "),s("p",[t._v("我保留这个建议")]),t._v(" "),s("p",[s("code",[t._v("sudo apt install apt-transport-https ca-certificates")])]),t._v(" "),s("p",[t._v("首先替换Debian 的软件源，配置文件是 /etc/apt/sources.list")]),t._v(" "),s("p",[t._v("可以使用一键换源脚本换源")]),t._v(" "),s("p",[s("code",[t._v("bash <(curl -sSL https://linuxmirrors.cn/main.sh)")])]),t._v(" "),s("p",[t._v("之后替换 pve 软件源")]),t._v(" "),s("p",[t._v("pve 镜像默认的 pve 软件源配置文件是 /etc/apt/sources.list.d/pve-enterprise.list")]),t._v(" "),s("p",[t._v("cp /etc/apt/sources.list /etc/apt/sources.list_back\n备份后将其中内容替换为以下即可：")]),t._v(" "),s("p",[t._v("vi /etc/apt/sources.list.d/pve-enterprise.list")]),t._v(" "),s("p",[t._v("#修改成以下内容\ndeb https://mirrors.ustc.edu.cn/proxmox/debian bookworm pve-no-subscription")]),t._v(" "),s("h4",{attrs:{id:"另外的一个帖子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#另外的一个帖子"}},[t._v("#")]),t._v(" 另外的一个帖子：")]),t._v(" "),s("p",[t._v('echo "deb https://mirrors.tuna.tsinghua.edu.cn/proxmox/debian bookworm pve-no-subscription" > /etc/apt/sources.list.d/pve-no-subscription.list')]),t._v(" "),s("p",[t._v("完成之后运行以下指令把软件源的密钥安装一下")]),t._v(" "),s("p",[t._v("wget https://mirrors.ustc.edu.cn/proxmox/debian/proxmox-release-bookworm.gpg -O /etc/apt/trusted.gpg.d/proxmox-release-bookworm.gpg")]),t._v(" "),s("p",[t._v("编辑 PVE ceph 源 配置文件是 /etc/apt/sources.list.d/ceph.list")]),t._v(" "),s("p",[t._v("vi /etc/apt/sources.list.d/ceph.list")]),t._v(" "),s("h5",{attrs:{id:"改成如下内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#改成如下内容"}},[t._v("#")]),t._v(" 改成如下内容")]),t._v(" "),s("p",[t._v("deb https://mirrors.ustc.edu.cn/proxmox/debian/ceph-quincy bookworm no-subscription")]),t._v(" "),s("p",[t._v("然后就可以愉快的更新软件源了")]),t._v(" "),s("p",[t._v("apt update")]),t._v(" "),s("p",[t._v("修改 CT Templates (LXC 容器) 源")]),t._v(" "),s("h4",{attrs:{id:"将-usr-share-perl5-pve-aplinfo-pm-文件中默认的源地址-http-download-proxmox-com"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#将-usr-share-perl5-pve-aplinfo-pm-文件中默认的源地址-http-download-proxmox-com"}},[t._v("#")]),t._v(" 将 /usr/share/perl5/PVE/APLInfo.pm 文件中默认的源地址 http://download.proxmox.com")]),t._v(" "),s("h4",{attrs:{id:"替换为-https-mirrors-tuna-tsinghua-edu-cn-proxmox-即可"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#替换为-https-mirrors-tuna-tsinghua-edu-cn-proxmox-即可"}},[t._v("#")]),t._v(" 替换为 https://mirrors.tuna.tsinghua.edu.cn/proxmox 即可")]),t._v(" "),s("p",[t._v("cp /usr/share/perl5/PVE/APLInfo.pm /usr/share/perl5/PVE/APLInfo.pm_back\nsed -i 's|http://download.proxmox.com|https://mirrors.ustc.edu.cn/proxmox|g' /usr/share/perl5/PVE/APLInfo.pm\n针对 /usr/share/perl5/PVE/APLInfo.pm 文件的修改，重启后生效")]),t._v(" "),s("h4",{attrs:{id:"去除订阅弹窗"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#去除订阅弹窗"}},[t._v("#")]),t._v(" 去除订阅弹窗")]),t._v(" "),s("p",[t._v('sed -Ezi.bak "s/(Ext.Msg.show({\\s+title: gettext(\'No valid sub)/void({ //\\1/g" /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js')]),t._v(" "),s("h4",{attrs:{id:"重启pve服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重启pve服务"}},[t._v("#")]),t._v(" 重启pve服务")]),t._v(" "),s("p",[t._v("systemctl restart pvedaemon.service\nsystemctl restart pveproxy.service")]),t._v(" "),s("p",[t._v("systemctl restart pvedaemon.service && systemctl restart pveproxy.service")]),t._v(" "),s("p",[t._v("参考：")]),t._v(" "),s("p",[t._v("https://lovesykun.cn/archives/36.html\nhttps://linuxmirrors.cn/\nhttps://www.dgpyy.com/archives/174/\nhttps://www.cnblogs.com/amsilence/p/18363272\nhttps://zhuanlan.zhihu.com/p/665213328")]),t._v(" "),s("p",[t._v("PVE折腾帖子：\nhttps://www.dgpyy.com/archives/174/\nhttps://ifwww.com/posts/61099.html#%E6%9B%B4%E6%8D%A2-debian-%E6%BA%90\nhttps://kecq.com/artic-16933746.html\nhttps://www.geekxw.top/1182/\nhttps://lovesykun.cn/archives/36.html")]),t._v(" "),s("p",[t._v("部分过时内容")]),t._v(" "),s("p",[t._v("https://www.cnblogs.com/amsilence/p/18363272")])])}),[],!1,null,null,null);s.default=r.exports}}]);